# 📝 **Linux `sort` 命令详解**

`sort` 是 Linux 中用于对文本内容进行排序的常用命令，可以按字母顺序、数字顺序、字段、指定分隔符、反向排序等方式进行排序。它支持非常丰富的排序规则。

------

# 1. 基本语法

```bash
sort [选项] [文件...]
```

如果不指定文件，则从 **标准输入** 读取数据。

------

# 2. 最常用选项

| 选项      | 含义                            |
| --------- | ------------------------------- |
| `-n`      | 按数字排序（number）            |
| `-r`      | 倒序排序（reverse）             |
| `-k`      | 指定排序字段（key）             |
| `-t`      | 指定分隔符（分隔字段）          |
| `-u`      | 去重（unique）                  |
| `-o file` | 将结果输出到指定文件            |
| `-g`      | 通用数值排序（支持科学计数法）  |
| `-h`      | 按人类可读数字排序（如 1K, 2M） |
| `-M`      | 按月份排序（JAN、FEB…）         |
| `-c`      | 检查文件是否已排序              |
| `-V`      | “版本号”排序，如 v1.9 < v1.10   |

------

# 3. 基本示例

### 📌 **按字典序排序（默认）**

```bash
sort file.txt
```

------

# 4. 数字排序

### 📌 **升序数字排序**

```bash
sort -n file.txt
```

🔍 字典序 VS 数字排序示例：

```txt
2
11
3
```

- 字典序：`11 2 3`
- 数字序：`2 3 11`

------

# 5. 倒序排序

```bash
sort -r file.txt
```

也可和数字排序结合：

```bash
sort -nr file.txt
```

------

# 6. 指定字段排序（-k）

假设文件内容如下（以空格为默认分隔）：

```txt
alice 30
bob 25
carol 20
```

### 📌 按第二列数字排序：

```bash
sort -k 2 -n file.txt
```

------

# 7. 指定分隔符（-t）

例如 CSV 文件：

```txt
alice,30
bob,25
carol,20
```

### 📌 以逗号分隔并按第二列排序：

```bash
sort -t ',' -k 2 -n file.csv
```

------

# 8. 字段范围（-k N,M）

格式：

```
-k 起始列,结束列
```

例如按第 2 到第 3 列进行综合排序：

```bash
sort -k 2,3 file.txt
```

------

# 9. 去重（-u）

```bash
sort -u file.txt
```

⚠️ 等价于：

```bash
sort file.txt | uniq
```

如果想按第二列去重：

```bash
sort -t ',' -k2,2 -u file.csv
```

------

# 10. 版本号排序（-V）

```bash
sort -V versions.txt
```

示例输入：

```
v1.9
v1.10
v1.2
```

排序结果：

```
v1.2
v1.9
v1.10
```

------

# 11. 人类可读数字排序（-h）

适合排序 df 输出：

```bash
du -h | sort -h
```

支持：

- 1K
- 10M
- 3G
- 2T

------

# 12. 按月份排序（-M）

```txt
Jan
Feb
Mar
Dec
Aug
```

排序命令：

```bash
sort -M months.txt
```

------

# 13. 输出到文件（-o）

```bash
sort file.txt -o sorted.txt
```

------

# 14. 检查文件是否已排序（-c）

```bash
sort -c file.txt
```

若无输出表示已排序。

------

# 15. 多重排序关键字

例如按第一列升序、第二列降序：

```bash
sort -k1,1 -k2,2r file.txt
```

------

# 16. 实战示例汇总

------

### ✔ 排序 nginx 日志（按请求时间）

```bash
awk '{print $NF}' access.log | sort -n
```

------

### ✔ 按文件大小排序（ls 输出）

```bash
ls -lh | sort -k 5 -h
```

------

### ✔ 排序进程内存占用

```bash
ps aux | sort -k 4 -n
```

------

### ✔ 排序 JSON 行（按字段）

适用于 jq 输出：

```bash
jq -r '.[] | "\(.name) \(.age)"' data.json | sort -k2,2n
```

------

# 🎯 总结

`sort` 是 Linux 文本处理的核心命令之一，可以通过：

- `-k` 指定字段
- `-t` 设置分隔符
- `-n` 数字排序
- `-h` 人类可读数字排序
- `-V` 版本号排序
- 多重键排序

