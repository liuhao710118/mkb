# ğŸ§­ `find` å‘½ä»¤æ•™ç¨‹æ–‡æ¡£

## ä¸€ã€å‘½ä»¤ç®€ä»‹

`find` ç”¨äºåœ¨æŒ‡å®šç›®å½•ä¸­**é€’å½’æœç´¢æ–‡ä»¶å’Œç›®å½•**ï¼Œå¹¶å¯æ ¹æ®å„ç§æ¡ä»¶ï¼ˆåç§°ã€ç±»å‹ã€æ—¶é—´ã€å¤§å°ã€æƒé™ç­‰ï¼‰æ‰§è¡Œæ“ä½œï¼ˆå¦‚åˆ é™¤ã€å¤åˆ¶ã€ç§»åŠ¨ã€ç»Ÿè®¡ç­‰ï¼‰ã€‚

------

## äºŒã€åŸºæœ¬è¯­æ³•

```bash
find [èµ·å§‹è·¯å¾„] [æœç´¢æ¡ä»¶] [å¤„ç†åŠ¨ä½œ]
```

**è¯´æ˜ï¼š**

- `[èµ·å§‹è·¯å¾„]`ï¼šä»å“ªä¸ªç›®å½•å¼€å§‹æŸ¥æ‰¾ï¼ˆå¯å¤šä¸ªï¼‰ï¼Œå¦‚ `/home`ã€`.`ã€`/var/log` ç­‰ã€‚
- `[æœç´¢æ¡ä»¶]`ï¼šæŒ‰æ–‡ä»¶åã€ç±»å‹ã€å¤§å°ã€æ—¶é—´ç­‰ç­›é€‰ã€‚
- `[å¤„ç†åŠ¨ä½œ]`ï¼šå¯¹æ‰¾åˆ°çš„ç»“æœæ‰§è¡Œæ“ä½œï¼Œå¦‚ `-print`ã€`-delete`ã€`-exec` ç­‰ã€‚

------

## ä¸‰ã€å¸¸ç”¨é€‰é¡¹ä¸å‚æ•°

### ğŸ¯ 1ï¸âƒ£ æŒ‰åç§°æŸ¥æ‰¾

```bash
find /path -name "filename"
find /path -name "*.log"
find /path -iname "*.jpg"      # å¿½ç•¥å¤§å°å†™
```

### ğŸ¯ 2ï¸âƒ£ æŒ‰ç±»å‹æŸ¥æ‰¾

```bash
find /path -type f   # æ™®é€šæ–‡ä»¶
find /path -type d   # ç›®å½•
find /path -type l   # ç¬¦å·é“¾æ¥
```

### ğŸ¯ 3ï¸âƒ£ æŒ‰å¤§å°æŸ¥æ‰¾

```bash
find /path -size +100M     # å¤§äº100MB
find /path -size -10k      # å°äº10KB
find /path -size +1G -size -2G   # ä»‹äº1Gåˆ°2Gä¹‹é—´
```

> å•ä½ï¼š`b`ï¼ˆå­—èŠ‚ï¼‰ã€`k`ã€`M`ã€`G`

### ğŸ¯ 4ï¸âƒ£ æŒ‰ä¿®æ”¹æ—¶é—´æŸ¥æ‰¾

```bash
find /path -mtime -7       # 7å¤©å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶
find /path -mtime +30      # 30å¤©å‰ä¿®æ”¹çš„æ–‡ä»¶
find /path -atime -1       # æœ€è¿‘ä¸€å¤©è®¿é—®è¿‡çš„æ–‡ä»¶
find /path -ctime -2       # æœ€è¿‘2å¤©å†…çŠ¶æ€æ”¹å˜çš„æ–‡ä»¶ï¼ˆæƒé™/é“¾æ¥å˜åŒ–ï¼‰
```

> `mtime`ï¼ˆå†…å®¹ä¿®æ”¹æ—¶é—´ï¼‰
>  `ctime`ï¼ˆå…ƒæ•°æ®ä¿®æ”¹æ—¶é—´ï¼‰
>  `atime`ï¼ˆè®¿é—®æ—¶é—´ï¼‰

------

## å››ã€é€»è¾‘ç»„åˆæ¡ä»¶

```bash
find / -type f -name "*.log" -o -name "*.txt"    # æˆ–å…³ç³»
find / -type f -name "*.log" -a -size +10M       # ä¸å…³ç³»ï¼ˆé»˜è®¤ï¼‰
find / -type f ! -name "*.bak"                   # é
```

------

## äº”ã€æŒ‰æƒé™ä¸å±ä¸»æŸ¥æ‰¾

```bash
find / -perm 644            # æƒé™æ­£å¥½æ˜¯ 644
find / -perm -111           # å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä»»ä½•äººéƒ½æœ‰æ‰§è¡Œæƒé™ï¼‰
find / -user root           # å±ä¸»æ˜¯ root
find / -group nginx         # å±ç»„æ˜¯ nginx
```

------

## å…­ã€æ‰§è¡ŒåŠ¨ä½œï¼ˆé‡ç‚¹ï¼‰

| åŠ¨ä½œ                  | è¯´æ˜                                 |
| --------------------- | ------------------------------------ |
| `-print`              | è¾“å‡ºç»“æœï¼ˆé»˜è®¤åŠ¨ä½œï¼‰                 |
| `-delete`             | åˆ é™¤åŒ¹é…çš„æ–‡ä»¶æˆ–ç›®å½•                 |
| `-exec command {} \;` | å¯¹æ¯ä¸ªç»“æœæ‰§è¡Œå‘½ä»¤ï¼ˆä¸€æ¬¡ä¸€æ¬¡ï¼‰       |
| `-exec command {} +`  | ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ç»“æœä¼ å…¥å‘½ä»¤ï¼ˆæ•ˆç‡æ›´é«˜ï¼‰ |
| `-ok command {} \;`   | ç±»ä¼¼ `-exec`ï¼Œä½†æ¯æ¬¡æ‰§è¡Œå‰è¯¢é—®ç¡®è®¤   |

### ç¤ºä¾‹ï¼š

```bash
find /var/log -name "*.log" -delete
find /home -type f -name "*.bak" -exec rm -f {} \;
find . -name "*.py" -exec grep -H "import" {} \;
```

------

## ä¸ƒã€æ€§èƒ½ä¼˜åŒ–

### âœ… é™åˆ¶æœç´¢æ·±åº¦

```bash
find /path -maxdepth 1      # ä»…å½“å‰ç›®å½•
find /path -mindepth 2      # ä»ç¬¬äºŒå±‚å¼€å§‹
```

### âœ… ä»…é™å½“å‰æ–‡ä»¶ç³»ç»Ÿ

```bash
find /path -xdev
```

### âœ… ä¸ `xargs` é…åˆä½¿ç”¨ï¼ˆé«˜æ•ˆæ‰¹é‡æ‰§è¡Œï¼‰

```bash
find /path -type f -name "*.log" | xargs rm -f
find / -type f -name "*.conf" | xargs grep "nginx"
```

> âš ï¸ æ³¨æ„ï¼šæ–‡ä»¶ååŒ…å«ç©ºæ ¼æ—¶å»ºè®®ä½¿ç”¨ `-print0` + `xargs -0`

```bash
find /path -type f -print0 | xargs -0 rm -f
```

------

## å…«ã€å¸¸è§å®æˆ˜æ¡ˆä¾‹ ğŸ’ª

| ç›®çš„                             | å‘½ä»¤                                                    |
| -------------------------------- | ------------------------------------------------------- |
| æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰å¤§äº500Mçš„æ–‡ä»¶ | `find . -type f -size +500M -exec ls -lh {} \;`         |
| åˆ é™¤7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶              | `find /var/log -type f -name "*.log" -mtime +7 -delete` |
| æŸ¥æ‰¾å«ç‰¹å®šå†…å®¹çš„æ–‡ä»¶             | `find . -type f -exec grep -H "keyword" {} \;`          |
| æŸ¥æ‰¾æœ€è¿‘ä¿®æ”¹çš„10ä¸ªæ–‡ä»¶           | `find . -type f -printf '%T@ %p\n'                      |
| ç»Ÿè®¡æŸç±»å‹æ–‡ä»¶æ•°é‡               | `find . -type f -name "*.py"                            |
| å°†ç»“æœæ‰“åŒ…æˆå‹ç¼©åŒ…               | `find . -name "*.log"                                   |
| æŸ¥æ‰¾å¹¶åˆ é™¤ç©ºç›®å½•                 | `find . -type d -empty -delete`                         |
| æŸ¥æ‰¾ç¬¦å·é“¾æ¥æ–‡ä»¶                 | `find / -type l -ls`                                    |

------

## ä¹ã€ç»„åˆè¿›é˜¶æŠ€å·§

### ğŸ”¹ ä½¿ç”¨æ­£åˆ™åŒ¹é…æ–‡ä»¶å

```bash
find . -regex ".*\.\(txt\|log\|cfg\)$"
find . -iregex ".*\(jpg\|png\|jpeg\)$"
```

### ğŸ”¹ æŸ¥æ‰¾å¹¶ç§»åŠ¨æ–‡ä»¶

```bash
find /source -type f -name "*.txt" -exec mv {} /target/ \;
```

### ğŸ”¹ æŸ¥æ‰¾å¹¶å‹ç¼©

```bash
find /data -type f -mtime +30 -exec gzip {} \;
```

------

## ğŸ”Ÿ `find` ä¸ `grep` çš„ç»“åˆ

æœç´¢æ–‡ä»¶ä¸­åŒ…å«ç‰¹å®šå†…å®¹çš„è¡Œï¼ˆæŒ‰è·¯å¾„ç­›é€‰ï¼‰ï¼š

```bash
find /etc -type f -name "*.conf" -exec grep -H "listen" {} \;
```

------

## ğŸ“˜ åä¸€ã€æ€»ç»“è¡¨ï¼ˆé€ŸæŸ¥ï¼‰

| åˆ†ç±» | å‚æ•°               | ç¤ºä¾‹               | å«ä¹‰         |
| ---- | ------------------ | ------------------ | ------------ |
| è·¯å¾„ | `/path`            | `find /etc`        | ä» /etc å¼€å§‹ |
| åç§° | `-name "*.log"`    | æ¨¡ç³ŠåŒ¹é…           |              |
| ç±»å‹ | `-type f/d/l`      | æ–‡ä»¶ / ç›®å½• / é“¾æ¥ |              |
| å¤§å° | `-size +100M`      | å¤§äº100M           |              |
| æ—¶é—´ | `-mtime +7`        | è¶…è¿‡7å¤©            |              |
| æƒé™ | `-perm 644`        | æƒé™åŒ¹é…           |              |
| ç”¨æˆ· | `-user root`       | å±ä¸»ä¸ºroot         |              |
| åŠ¨ä½œ | `-delete`ã€`-exec` | æ‰§è¡Œæ“ä½œ           |              |
| é€»è¾‘ | `-a`ã€`-o`ã€`!`    | ä¸ã€æˆ–ã€é         |              |

