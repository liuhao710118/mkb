# **Linux `nice` 命令教程文档**

`nice` 主要用于 **设置程序的优先级（优先级越低，nice 值越高）**。
 是 Linux 下控制 CPU 调度的重要命令之一，适用于限制后台程序对 CPU 的抢占。

------

# **一、基本概念**

## **1. 什么是 nice 值？**

- nice 值范围：**-20 ~ 19**
- 默认值：**0**
- nice 值越低（如 -10、-20）→ 优先级越高
- nice 值越高（如 10、19）→ 优先级越低（更“友好”地让出 CPU）

| nice 值 | 优先级含义                   |
| ------- | ---------------------------- |
| **-20** | 最高优先级（需要 root 权限） |
| **0**   | 默认优先级                   |
| **19**  | 最低优先级                   |

------

# **二、命令语法**

```
nice [选项] [命令]
```

常用选项：

| 选项        | 含义                       |
| ----------- | -------------------------- |
| **-n <值>** | 设置 nice 数值（可正可负） |

------

# **三、普通用法示例**

## **1. 使用默认 nice 值运行程序（0）**

```
nice top
```

------

## **2. 设置低优先级（nice 值增加）运行程序**

适用于耗 CPU 的后台任务：

```
nice -n 10 python3 test.py
```

这样该程序就会让出 CPU 资源给更重要的任务。

------

## **3. 将程序设置为非常低优先级（避免抢占 CPU）**

```
nice -n 19 tar -czf backup.tar.gz /data
```

------

## **4. 提高程序优先级（降低 nice 值，需要 root）**

```
sudo nice -n -5 ./run.sh
```

------

# **四、查看正在运行的进程的 nice 值**

使用 `ps`：

```
ps -o pid,comm,nice -p <PID>
```

使用 `top`（按 **Shift + f**，选择 **n** 字段）可以在列表看到 nice 值。

------

# **五、配套命令：renice（修改已运行程序的 nice 值）**

`nice` 是“启动时指定优先级”；
 `renice` 是“运行中修改优先级”。

示例：把进程 1234 的 nice 改为 5：

```
renice -n 5 -p 1234
```

提高优先级（需要 root）：

```
sudo renice -n -10 -p 1234
```

------

# **六、实际运维场景示例**

## **1. 备份任务很占 CPU，需要降低优先级**

```
nice -n 15 rsync -av /data /backup
```

保证备份不影响在线业务。

------

## **2. 训练 AI 模型但不影响 Web 服务**

```
nice -n 10 python train.py
```

------

## **3. 提升数据库进程优先级（root）**

```
sudo renice -n -5 -p 2345
```

确保数据库响应更快。

------

# **七、总结**

| 命令       | 作用                        |
| ---------- | --------------------------- |
| **nice**   | 启动程序时设置其 CPU 优先级 |
| **renice** | 修改已经运行程序的优先级    |

最常用示例：

```
nice -n 10 <command>        # 降低优先级
sudo nice -n -10 <command>  # 提高优先级
ps -o pid,comm,nice         # 查看 nice 值
```

