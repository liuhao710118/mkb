# **Linux `free` 命令教程文档**

`free` 用于查看 **系统内存（RAM）和 Swap（交换分区）** 的使用情况，是 Linux 运维中最常用的内存查看工具之一。

------

# **一、基本语法**

```
free [选项]
```

------

# **二、常用选项**

| 选项      | 说明                                      |
| --------- | ----------------------------------------- |
| **-h**    | 以易读格式显示（自动换算 KB/MB/GB）       |
| **-m**    | 以 MB 显示                                |
| **-g**    | 以 GB 显示                                |
| **-k**    | 以 KB 显示（默认）                        |
| **-s 秒** | 每隔指定秒数刷新一次                      |
| **-t**    | 显示内存 + swap 的总和                    |
| **--si**  | 使用 1000 进制（MB=1000×1000）而不是 1024 |

**最常用：**

```
free -h
```

------

# **三、输出内容解读**

执行：

```
free -h
```

示例输出：

```
               total        used        free      shared  buff/cache   available
Mem:            15G        2.0G        9.3G        350M        3.8G         12G
Swap:            2G          0B         2G
```

下面解释每一列含义：

------

## **1. Mem（实际内存）**

| 字段           | 含义                              |
| -------------- | --------------------------------- |
| **total**      | 物理内存总量                      |
| **used**       | 已使用内存（不包含 cache/buffer） |
| **free**       | 空闲内存（未分配的）              |
| **shared**     | tmpfs 等共享内存                  |
| **buff/cache** | Linux 用于缓存文件系统的内存      |
| **available**  | *真正可用* 的内存（最重要）       |

------

## **2. Swap（交换区）**

| 字段      | 含义        |
| --------- | ----------- |
| **total** | swap 总大小 |
| **used**  | 已使用 swap |
| **free**  | 空闲 swap   |

------

# **四、Linux 内存机制重点说明（非常重要）**

Linux 会尽可能用空闲内存当缓存（cache）提高读写速度，所以：

- **free 较低不代表内存不足**
- **看 available 才准确**

例如：

```
free = 100M   （看起来像内存不够）
available = 10G   （实际还很充裕）
```

运维判断内存够不够 → **只看 available**

------

# **五、常用示例**

## **1. 以人类可读格式显示**

```
free -h
```

------

## **2. 以 MB 显示内存**

```
free -m
```

------

## **3. 每 1 秒刷新显示内存变化**

```
free -h -s 1
```

适合监控程序是否在占用内存增长（排查内存泄露）。

------

## **4. 显示内存 + swap 总量**

```
free -t -h
```

------

## **5. 使用 SI 计算单位（1000 进制）**

```
free --si -h
```

------

# **六、如何判断系统是否真的缺内存？**

### 看 `available` 内存：

```
available < 1G
```

→ **内存不足，可能需要加内存或优化程序**

------

### 看 swap 是否在使用：

```
used swap > 0
```

→ 系统开始用 swap，会变慢

------

### 看业务进程内存变化：

用：

```
top
htop
ps aux --sort=-%mem
```

------

### 可能内存不足的信号：

- `available` 非常小（<5%）

- swap 不断增长

- OOM-killer 日志出现：

  ```
  dmesg | grep -i kill
  ```

------

# **七、总结**

`free` 命令用于查看内存的最核心指标：

| 关键字段      | 是否重要 | 说明                        |
| ------------- | -------- | --------------------------- |
| **available** | ⭐⭐⭐⭐⭐    | 真正可用内存（最重要）      |
| used          | ⭐⭐⭐      | 已使用（不含 buffer/cache） |
| cache         | ⭐⭐⭐      | 文件缓存（可回收）          |
| swap used     | ⭐⭐⭐⭐     | 是否出现 swap 使用          |

最常用命令：

```
free -h
free -h -s 1     # 实时监控
free -m          # MB 显示
```

