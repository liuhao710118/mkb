# Linux `tar` å‘½ä»¤ä½¿ç”¨æ•™ç¨‹

## ä¸€ã€å‘½ä»¤ç®€ä»‹

`tar`ï¼ˆtape archiveï¼‰å‘½ä»¤æœ€åˆç”¨äºå°†æ–‡ä»¶å¤‡ä»½åˆ°ç£å¸¦è®¾å¤‡ï¼Œç°åœ¨ä¸»è¦ç”¨äº**æ‰“åŒ…ä¸å‹ç¼©**æ–‡ä»¶å’Œç›®å½•ã€‚

`tar` å¯ä»¥ï¼š

- æ‰“åŒ…å¤šä¸ªæ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼›
- åŒæ—¶æ”¯æŒå¤šç§å‹ç¼©ç®—æ³•ï¼ˆgzipã€bzip2ã€xzï¼‰ï¼›
- ä¿ç•™æ–‡ä»¶çš„æƒé™ã€æ—¶é—´æˆ³ç­‰å…ƒæ•°æ®ï¼›
- æ–¹ä¾¿å¤‡ä»½ä¸ä¼ è¾“ã€‚

------

## äºŒã€åŸºæœ¬è¯­æ³•

```bash
tar [é€‰é¡¹] [å½’æ¡£æ–‡ä»¶å] [æ–‡ä»¶æˆ–ç›®å½•]
```

å¸¸ç”¨æ ¼å¼ï¼š

| åŠŸèƒ½         | å‘½ä»¤æ ¼å¼                              |
| ------------ | ------------------------------------- |
| æ‰“åŒ…         | `tar -cvf archive.tar source_dir`     |
| æ‰“åŒ…å¹¶å‹ç¼©   | `tar -czvf archive.tar.gz source_dir` |
| è§£å‹         | `tar -xvf archive.tar`                |
| è§£å‹å¹¶è§£å‹ç¼© | `tar -xzvf archive.tar.gz`            |

------

## ä¸‰ã€å¸¸ç”¨é€‰é¡¹è¯´æ˜

| é€‰é¡¹                | å«ä¹‰                               |
| ------------------- | ---------------------------------- |
| `-c`                | åˆ›å»ºæ–°çš„å½’æ¡£æ–‡ä»¶ï¼ˆcreateï¼‰         |
| `-x`                | ä»å½’æ¡£ä¸­æå–æ–‡ä»¶ï¼ˆextractï¼‰        |
| `-v`                | æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹ï¼ˆverboseï¼‰            |
| `-f`                | æŒ‡å®šå½’æ¡£æ–‡ä»¶åï¼ˆfileï¼‰             |
| `-z`                | ä½¿ç”¨ gzip å‹ç¼©ï¼ˆç”Ÿæˆ `.tar.gz`ï¼‰   |
| `-j`                | ä½¿ç”¨ bzip2 å‹ç¼©ï¼ˆç”Ÿæˆ `.tar.bz2`ï¼‰ |
| `-J`                | ä½¿ç”¨ xz å‹ç¼©ï¼ˆç”Ÿæˆ `.tar.xz`ï¼‰     |
| `-t`                | åˆ—å‡ºå½’æ¡£æ–‡ä»¶çš„å†…å®¹ï¼ˆlistï¼‰         |
| `-C`                | è§£å‹åˆ°æŒ‡å®šç›®å½•ï¼ˆchange directoryï¼‰ |
| `--exclude=PATTERN` | æ’é™¤åŒ¹é…çš„æ–‡ä»¶æˆ–ç›®å½•               |

------

## å››ã€å¸¸è§æ“ä½œç¤ºä¾‹

### 1ï¸âƒ£ æ‰“åŒ…ç›®å½•

```bash
tar -cvf backup.tar /home/user/docs
```

> å°† `/home/user/docs` ç›®å½•æ‰“åŒ…ä¸º `backup.tar`ï¼Œä¸å‹ç¼©ã€‚

------

### 2ï¸âƒ£ æ‰“åŒ…å¹¶å‹ç¼©ï¼ˆgzipï¼‰

```bash
tar -czvf backup.tar.gz /home/user/docs
```

> ä½¿ç”¨ gzip å‹ç¼©ï¼Œç”Ÿæˆ `.tar.gz` æ–‡ä»¶ã€‚

------

### 3ï¸âƒ£ æ‰“åŒ…å¹¶å‹ç¼©ï¼ˆbzip2ï¼‰

```bash
tar -cjvf backup.tar.bz2 /home/user/docs
```

> ä½¿ç”¨ bzip2 å‹ç¼©ï¼Œå‹ç¼©ç‡æ›´é«˜ä½†é€Ÿåº¦è¾ƒæ…¢ã€‚

------

### 4ï¸âƒ£ æ‰“åŒ…å¹¶å‹ç¼©ï¼ˆxzï¼‰

```bash
tar -cJvf backup.tar.xz /home/user/docs
```

> ä½¿ç”¨ xz å‹ç¼©ï¼Œå‹ç¼©ç‡æœ€é«˜ï¼Œé€‚åˆå¤§æ–‡ä»¶å½’æ¡£ã€‚

------

### 5ï¸âƒ£ è§£å‹ `.tar.gz` æ–‡ä»¶

```bash
tar -xzvf backup.tar.gz
```

> è§£å‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚

------

### 6ï¸âƒ£ è§£å‹åˆ°æŒ‡å®šç›®å½•

```bash
tar -xzvf backup.tar.gz -C /opt/restore
```

> å°†å‹ç¼©åŒ…è§£å‹åˆ° `/opt/restore`ã€‚

------

### 7ï¸âƒ£ æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹

```bash
tar -tzvf backup.tar.gz
```

> ä¸è§£å‹ï¼Œä»…æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ã€‚

------

### 8ï¸âƒ£ æ‰“åŒ…æ—¶æ’é™¤æ–‡ä»¶

```bash
tar -czvf backup.tar.gz /home/user --exclude=/home/user/tmp --exclude='*.log'
```

> æ‰“åŒ… `/home/user` æ—¶æ’é™¤ `tmp` ç›®å½•å’Œæ‰€æœ‰ `.log` æ–‡ä»¶ã€‚

------

### 9ï¸âƒ£ è¿½åŠ æ–‡ä»¶åˆ°å·²æœ‰ tar åŒ…ï¼ˆä¸æ”¯æŒå‹ç¼©æ ¼å¼ï¼‰

```bash
tar -rvf backup.tar newfile.txt
```

> å‘ `backup.tar` è¿½åŠ ä¸€ä¸ªæ–‡ä»¶ã€‚

------

### ğŸ”Ÿ ä»…æ‰“åŒ…ç›¸å¯¹è·¯å¾„ï¼ˆé¿å…åŒ…å«å®Œæ•´è·¯å¾„ï¼‰

```bash
cd /home/user
tar -czvf docs.tar.gz docs/
```

> æ‰“åŒ…æ—¶è·¯å¾„ä¸ºç›¸å¯¹è·¯å¾„ `docs/` è€Œä¸æ˜¯ `/home/user/docs`ã€‚

------

## äº”ã€è§£å‹ä¸åŒç±»å‹çš„å‹ç¼©åŒ…æ€»ç»“

| å‹ç¼©åŒ…æ ¼å¼ | è§£å‹å‘½ä»¤                 |
| ---------- | ------------------------ |
| `.tar`     | `tar -xvf file.tar`      |
| `.tar.gz`  | `tar -xzvf file.tar.gz`  |
| `.tar.bz2` | `tar -xjvf file.tar.bz2` |
| `.tar.xz`  | `tar -xJvf file.tar.xz`  |

------

## å…­ã€å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹

1. **å¿…é¡»ä½¿ç”¨ `-f` å‚æ•°æŒ‡å®šæ–‡ä»¶å**ï¼Œå¦åˆ™ `tar` ä¼šè®¤ä¸ºæ–‡ä»¶åæ˜¯é€‰é¡¹ã€‚

   ```bash
   tar -cvf archive.tar file1 file2
   ```

2. **å‹ç¼©é€‰é¡¹åªèƒ½é€‰ä¸€ä¸ª**ï¼ˆ`z`ã€`j`ã€`J` ä¸‰é€‰ä¸€ï¼‰ã€‚

3. **è·¯å¾„æƒé™é—®é¢˜**ï¼š
    å»ºè®®ä½¿ç”¨æ™®é€šç”¨æˆ·æ‰§è¡Œï¼Œé¿å…è¯¯æ‰“åŒ… `/proc`ã€`/sys` ç­‰è™šæ‹Ÿç›®å½•ã€‚

4. **å¤§æ–‡ä»¶åˆ†å·å‹ç¼©**ï¼ˆç¤ºä¾‹ï¼šæ¯å· 100MBï¼‰ï¼š

   ```bash
   tar -czf - /home/user | split -b 100M - backup.tar.gz.part-
   ```

   è§£å‹ï¼š

   ```bash
   cat backup.tar.gz.part-* | tar -xzvf -
   ```

------

## ä¸ƒã€å®ç”¨å°æŠ€å·§

| éœ€æ±‚                     | å‘½ä»¤                                  |
| ------------------------ | ------------------------------------- |
| åªè§£å‹éƒ¨åˆ†æ–‡ä»¶           | `tar -xzvf backup.tar.gz file1 file2` |
| è§£å‹å‰æŸ¥çœ‹å°†è¦æå–çš„æ–‡ä»¶ | `tar -tzvf backup.tar.gz`             |
| å‹ç¼©å½“å‰ç›®å½•æ‰€æœ‰å†…å®¹     | `tar -czvf all.tar.gz ./*`            |
| æŸ¥çœ‹å‹ç¼©æ¯”ä¾‹             | `gzip -l file.tar.gz`                 |

