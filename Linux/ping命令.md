# **Linux `ping 命令详细教程**

## 一、`ping` 是什么？

`ping` 用于测试当前主机到目标主机之间的 **网络连通性**，包括：

- 是否可达
- 延迟（时延 RTT）
- 丢包率
- 网络抖动情况

它通过 ICMP 协议发送回显请求（Echo Request），并接收响应。

------

# **二、基本语法**

```
ping [选项] 目标地址
```

可用于 IP 或域名，例如：

```
ping 8.8.8.8
ping www.google.com
```

------

# **三、常用参数说明**

| 参数        | 说明                                        |
| ----------- | ------------------------------------------- |
| `-c <次数>` | 指定发送包的数量（常用）                    |
| `-i <秒>`   | 每次发送的间隔时间（默认 1 秒）             |
| `-W <秒>`   | 超时时间（等待响应的最大时间）              |
| `-s <字节>` | 指定数据包大小                              |
| `-t <TTL>`  | 设置 TTL 值（Time To Live）                 |
| `-q`        | 静默输出，仅显示结果汇总                    |
| `-f`        | flood 模式（测试高负载网络，危险，需 root） |
| `-a`        | 有回显时响铃（beep）                        |
| `-4`        | 强制使用 IPv4                               |
| `-6`        | 强制使用 IPv6                               |

------

# **四、常用示例**

------

## **1. 连续 ping（直到 Ctrl+C）**

```
ping 8.8.8.8
```

------

## **2. 指定 ping n 次**

```
ping -c 4 8.8.8.8
```

输出示例：

```
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 10.592/11.880/13.011/1.010 ms
```

------

## **3. 修改发送间隔**

```
ping -i 0.2 8.8.8.8
```

每 0.2 秒 ping 一次。

------

## **4. 指定超时时间**

```
ping -W 2 192.168.1.1
```

每次 ping 最多等待 2 秒响应。

------

## **5. 修改包大小（测试网络 MTU）**

```
ping -s 1500 192.168.1.1
```

------

## **6. 使用指定 TTL**

```
ping -t 64 www.baidu.com
```

------

## **7. 静默模式（仅汇总）**

```
ping -c 5 -q 8.8.8.8
```

------

## **8. IPv6 专用**

```
ping6 -c 4 google.com
```

或：

```
ping -6 google.com
```

------

# **五、典型网络排查场景**

------

## **1. 测试某 IP 是否可达**

```
ping 192.168.0.1
```

### 常见情况分析：

| 现象     | 原因                             |
| -------- | -------------------------------- |
| ping 通  | 网络连通正常                     |
| 偶尔丢包 | 网络质量差、抖动大               |
| 完全不通 | 目标不存在、路由不通、防火墙阻断 |

------

## **2. 检查 DNS 是否正常**

```
ping www.google.com
```

如果域名不解析但 IP 可以 ping，说明 DNS 有问题。

------

## **3. 判断网络延迟是否稳定**

看 RTT（min/avg/max/mdev）是否波动大。

------

## **4. 判断是否 MTU 问题**

路径 MTU 检测：

```
ping -M do -s 1472 8.8.8.8
```

如果报错信息如：

```
Frag needed and DF set
```

说明 MTU 不够，需要调整。

------

# **六、输出结果解析**

典型输出：

```
64 bytes from 8.8.8.8: icmp_seq=1 ttl=115 time=19.6 ms
```

字段解释：

- **64 bytes**：返回包大小
- **from 8.8.8.8**：目标地址
- **icmp_seq=1**：序列号
- **ttl=115**：TTL（经过的路由数）
- **time=19.6 ms**：往返时间（RTT）

最终统计：

```
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 10.592/11.880/13.011/1.010 ms
```

代表最小、平均、最大 RTT 和抖动（mdev）。

------

# **七、注意事项**

- 部分主机可能屏蔽 ICMP，不代表服务不可达（如禁止 ping）
- `flood` 模式对网络压力非常大，慎用：

```
ping -f 8.8.8.8
```

------

# **八、快速 Cheat Sheet**

| 功能       | 命令                    |
| ---------- | ----------------------- |
| 指定次数   | `ping -c 4 IP`          |
| 指定包大小 | `ping -s 1400 IP`       |
| 指定间隔   | `ping -i 0.5 IP`        |
| IPv6 ping  | `ping -6 hostname`      |
| 静默输出   | `ping -q -c 4 IP`       |
| 测试 MTU   | `ping -M do -s 1472 IP` |

