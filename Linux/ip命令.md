# **Linux `ip` 命令教程（超详细）**

`ip` 命令由 *iproute2* 套件提供，用于 **查看与管理网络接口、IP 地址、路由、邻居（ARP）、链路、SR-IOV、隧道等**。

现代系统中：

- `ifconfig` → `ip addr` / `ip link`
- `route` → `ip route`
- `arp` → `ip neigh`

------

# **一、基本结构**

```
ip [对象] [动作] [参数]
```

对象包括：

| 对象        | 含义             |
| ----------- | ---------------- |
| **addr**    | IPv4/IPv6 地址   |
| **link**    | 网卡（链路层）   |
| **route**   | 路由             |
| **neigh**   | ARP/邻居缓存     |
| **maddr**   | 多播地址         |
| **rule**    | 路由策略规则     |
| **monitor** | 实时监控网络事件 |

------

# ---------------------------------------

# **二、查看网络接口和 IP 地址**

# ---------------------------------------

## **1. 查看所有网卡的 IP 地址（最常用）**

```
ip addr show
```

或简写：

```
ip a
```

输出示例：

```
2: eth0: <UP,BROADCAST,RUNNING> ...
    inet 192.168.1.10/24 brd 192.168.1.255 scope global eth0
    inet6 fe80::20c:29ff:fe12:abcd/64 scope link
```

------

## **2. 查看所有网卡（含未 UP 的）**

```
ip link show
```

或：

```
ip l
```

------

## **3. 查看某个接口**

```
ip addr show dev eth0
ip link show dev eth0
```

------

# ---------------------------------------

# **三、配置 IP 地址（临时）**

# ---------------------------------------

## **1. 添加 IP**

```
ip addr add 192.168.1.100/24 dev eth0
```

------

## **2. 删除 IP**

```
ip addr del 192.168.1.100/24 dev eth0
```

------

## **3. 替换 IP（推荐）**

```
ip addr replace 192.168.1.100/24 dev eth0
```

------

# ---------------------------------------

# **四、启用 / 禁用网络接口**

# ---------------------------------------

## **1. 启动网卡**

```
ip link set eth0 up
```

------

## **2. 关闭网卡**

```
ip link set eth0 down
```

------

## **3. 设置网卡 MTU**

```
ip link set eth0 mtu 1400
```

------

## **4. 修改 MAC 地址**

```
ip link set dev eth0 address 00:11:22:33:44:55
```

------

# ---------------------------------------

# **五、路由管理 (`ip route`)**

# ---------------------------------------

> [什么是路由表？看这里](./concept/iproute.md)

## **1. 查看路由表**

```
ip route show
```

常见输出：

```
default via 192.168.1.1 dev eth0
192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.10 
```

------

## **2. 添加默认路由**

```
ip route add default via 192.168.1.1
```

------

## **3. 删除默认路由**

```
ip route del default
```

------

## **4. 添加指定网段路由**

```
ip route add 10.0.0.0/24 via 192.168.1.254
```

------

## **5. 删除指定路由**

```
ip route del 10.0.0.0/24
```

------

# ---------------------------------------

# **六、邻居表（ARP）管理**

# ---------------------------------------



> [什么是ARP 看这里](./concept/ARP.md)



查看 ARP 表：

```
ip neigh
```

内容示例：

```
192.168.1.1 dev eth0 lladdr 00:11:22:33:44:55 REACHABLE
```

------

## **添加静态 ARP**

```
ip neigh add 192.168.1.1 lladdr 00:11:22:33:44:55 dev eth0 nud permanent
```

删除：

```
ip neigh del 192.168.1.1 dev eth0
```

------

# ---------------------------------------

# **七、多播地址管理**

# ---------------------------------------

查看多播：

```
ip maddr show
```

------

# ---------------------------------------

# **八、策略路由（高级）**

# ---------------------------------------

查看规则：

```
ip rule show
```

添加规则：

```
ip rule add from 192.168.1.10 table 100
```

添加路由表数据：

```
ip route add default via 192.168.1.1 table 100
```

（用于多出口、多 ISP 场景）

------

# ---------------------------------------

# **九、实时监控网络事件**

# ---------------------------------------

监控 IP、网卡、路由变化：

```
ip monitor
```

或：

```
ip monitor link
ip monitor addr
ip monitor route
```

非常适合排查网络异常、故障瞬断。

------

# ---------------------------------------

# **十、常用命令速查（最实用合集）**

# ---------------------------------------

| 功能         | 命令                                         |
| ------------ | -------------------------------------------- |
| 查看 IP      | `ip a`                                       |
| 查看网卡     | `ip l`                                       |
| 启动网卡     | `ip link set eth0 up`                        |
| 关闭网卡     | `ip link set eth0 down`                      |
| 添加 IP      | `ip addr add 192.168.1.10/24 dev eth0`       |
| 删除 IP      | `ip addr del 192.168.1.10/24 dev eth0`       |
| 添加默认路由 | `ip route add default via 192.168.1.1`       |
| 查看 ARP     | `ip neigh`                                   |
| 修改 MTU     | `ip link set eth0 mtu 1400`                  |
| 修改 MAC     | `ip link set eth0 address 00:11:22:33:44:55` |

------

# **十一、为什么 `ip` 比 `ifconfig` 强大？**

| 功能点             | `ifconfig`     | `ip`              |
| ------------------ | -------------- | ----------------- |
| IPv6               | 弱             | 完整              |
| 路由管理           | 分散 (`route`) | 统一 (`ip route`) |
| 多路由表/策略      | ❌              | ✔                 |
| SR-IOV/VLAN/Tunnel | 不支持         | ✔                 |
| 已维护             | ❌              | ✔（现代标准）     |

因此——**建议完全使用 `ip` 命令替代旧工具。**

